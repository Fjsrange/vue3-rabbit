### storeToRefs

使用storeToRefs函数可以辅助报吃数据（state+getter）的响应式解构

```js
// 响应式丢失 视图不再更新
const { count, increment, doubleCount, list } = countStore;
```

```
// 保持数据响应式
const { count, increment, doubleCount, list } = countStore;
```





1. pinia是用来做什么的？

   集中状态管理工具，新一代vuex

2. pinia中还需要mutation吗？

   不需要，action即支持同步也支持异步

3. pinia如何实现getter？

   computed计算属性函数

4. pinia产生的store如何解构赋值数据保持响应式？

   通过 storeToRefs 方法

   ```js
   import { storeToRefs } from 'pinia';
   const { count } = storeToRefs(countStore);
   ```





### 2 项目起步-初始化项目并使用git管理

#### git管理项目

基于create-vue创建出来的项目默认没有初始化git仓库，需要我们手动初始化



执行命令并完成首次提交

1. git init
2. git add .
3. git commit -m "初始化项目"



#### 什么是别名路径联想提示

在编写代码的过程中，一旦输入@/，vscode会立刻联想出src下的所有子目录和文件，统一文件路径访问不容易出错

1. 在项目的根目录下新增jsconfig.json文件
2. 添加json格式的配置项，如下：

```json
// jsconfig.json
{
  "compilerOptions": {
    "paths": {
      "@/*": ["./src/*"]
    }
  }
}
```

```json
import { fileURLToPath, URL } from 'node:url'

import { defineConfig } from 'vite'

// https://vite.dev/config/
export default defineConfig({
  resolve: {
    // 实际的路径转换 @ -> src
    alias: {
      '@': fileURLToPath(new URL('./src', import.meta.url))
    },
  },
})
```



### 4 项目起步-elementPlus引入



```
# 安装 
npm install element-plus --save

# 安装unplugin-vue-components 和 unplugin-auto-import这两款插件
# -D：只在开发环境运行
npm install -D unplugin-vue-components unplugin-auto-import
```



```js
// vite.config.js
import { defineConfig } from 'vite'
import AutoImport from 'unplugin-auto-import/vite'
import Components from 'unplugin-vue-components/vite'
import { ElementPlusResolver } from 'unplugin-vue-components/resolvers'

export default defineConfig({
  // ...
  plugins: [
    // ...
    AutoImport({
      resolvers: [ElementPlusResolver()],
    }),
    Components({
      resolvers: [ElementPlusResolver()],
    }),
  ],
})
```



### 5 项目起步-elementPlus主题定制

如何定制（scss变量替换方案）

1. 安装sass
2. 准备定制样式文件
3. 对elementPlus样式进行覆盖

通知element采用scss语言 -> 导入定制scss文件覆盖

1、安装sass

```bash
npm install sass -D
```



#### 2、准备定制样式文件

```scss
@forward "element-plus/theme-chalk/src/common/var.scss" with (
  $colors: (
    "primary": (
      // 主色
      "base": #27ba9b,
    ),
    "success": (
      // 成功色
      "base": #1dc779,
    ),
    "warning": (
      // 警告色
      "base": #ffb302,
    ),
    "danger": (
      // 危险色
      "base": #e26237,
    ),
    "error": (
      // 错误色
      "base": #cf4444,
    ),
  )
);
```



#### 3、自动导入配置

这里自动导入需要深入到elementPlus的组件中，按照官方的配置文档来

1. 配置elementPlus采用sass样式配色系统
2. 自动导入定制化样式文件进行样式覆盖

```js
import { fileURLToPath, URL } from "node:url";

import { defineConfig } from "vite";
import vue from "@vitejs/plugin-vue";
import vueDevTools from "vite-plugin-vue-devtools";

// elementPlus按需导入
import AutoImport from "unplugin-auto-import/vite";
import Components from "unplugin-vue-components/vite";
import { ElementPlusResolver } from "unplugin-vue-components/resolvers";

// https://vite.dev/config/
export default defineConfig({
  plugins: [
    vue(),
    vueDevTools(),
    AutoImport({
      resolvers: [ElementPlusResolver()],
    }),
    Components({
      resolvers: [
        // 1、配置elementPlus采用asaa样式配色系统
        ElementPlusResolver({ importStyle: "sass" }),
      ],
    }),
  ],
  resolve: {
    // 实际的路径转换 @ -> src
    alias: {
      "@": fileURLToPath(new URL("./src", import.meta.url)),
    },
  },
  css: {
    preprocessorOptions: {
      scss: {
        // 2、自动导入定制化样式文件进行样式覆盖
        additionalData: `@use "@/styles/element/index.scss" as *;`,
      },
    },
  },
});
```



### 6 项目起步-axios基础配置

1. 安装axios

   ```bash
   npm i axios
   ```

   

2. 配置基础实例（统一接口配置）

   1. 接口基地址
   2. 接口超时时间
   3. 请求拦截器
   4. 相应拦截器

简单封装axios

```js
// src/utils/http.js
// axios 基础封装
import axios from "axios";

const httpInstance = axios.create({
  baseURL: "http://pcapi-xiaotuxian-front-devtest.itheima.net",
  timeout: 5000,
});

// 请求拦截器
httpInstance.interceptors.request.use(
  (config) => {
    return config;
  },
  (e) => Promise.reject(e)
);

// 响应拦截器
httpInstance.interceptors.response.use(
  (res) => res.data,
  (e) => {
    return Promise.reject(e);
  }
);

export default httpInstance;
```



配置一个接口

```js
// src/apis/testApi.js
import httpInstance from "@/utils/http";

export function getCategory() {
  return httpInstance({
    url: "home/category/head",
  });
}
```



测试接口返回数据

```js
// src/main.js
// import './assets/main.css'

import { createApp } from "vue";
import { createPinia } from "pinia";

import App from "./App.vue";
import router from "./router";

// 测试接口函数
import { getCategory } from "@/apis/testApi";
getCategory().then((res) => {
  console.log("res", res);
});

const app = createApp(App);

app.use(createPinia());
app.use(router);

app.mount("#app");
```



### 7 项目起步-项目路由设计

设计首页和登录页的路由（一级路由）

路由设计原则：找内容切换的区域，如果是页面整体切换，则为一级路由

```js
// src/router/index.js
// createRouter:创建router实例对象
// createWebHistory:创建history路由模式
import { createRouter, createWebHistory } from "vue-router";

const router = createRouter({
  history: createWebHistory(import.meta.env.BASE_URL),
  routes: [
    {
      path: "/",
      name: "layout",
      component: () => import("@/views/Layout/index.vue"),
      children: [
        {
          path: "",
          name: "home",
          component: () => import("@/views/Home/index.vue"),
        },
        {
          path: "/category",
          name: "category",
          component: () => import("@/views/Category/index.vue"),
        },
      ],
    },
	// ...
  ],
});

export default router;
```



```vue
// APP.vue
<script setup>
import { RouterView } from "vue-router";
</script>

<template>
  <el-button type="primary">Primary</el-button>
  <!-- 一级路由出口 -->
  <RouterView />
</template>
```

```vue
<template>
  <div class="">
    首页
    <!-- 二级路由出口 -->
    <RouterView />
  </div>
</template>
```



1. 路由设计的依据是什么？

   内容切换的方式

2. 默认二级路由如何设置？

   给父级路由添加children，在二级路由的path配置项制空，并在vue页面添加<RouterView />



### 8 项目起步-静态资源初始化和ErrorLens安装

#### 图片资源和样式资源

资源说明

1. 实际工作中的图片资源通常由UI设计师提供，常见的图片格式有png，svg等都是由UI切图交给前端
2. 样式资源通常是指项目初始化的时候进行样式重置，常见的比如开源的normalize.css或者手写

资源操作

1. 图片资源：把images文件夹放到assets目录下
2. 样式资源：把common.scss文件放到styles目录下



文件地址：https://pan.baidu.com/s/1ZqjMxwZklZVYpB1ZbzEKKA&pwd=9987



#### error lens安装

error lens是一个实时提供错误警告信息的vscode插件，方便开发





### 9 项目起步-scss文件自动导入

#### 为什么要自动导入

在项目里一些组件共享的色值会以scss变量的方式统一放到一个名为var.scss的文件中，正常组件中使用，需要`先导入scss文件，再使用内部的变量`，比较繁琐，自动导入`可以免去手动导入的步骤，直接使用内部的变量`。



#### 自动导入配置

1. 新增一个var.scss文件，存入色值变量
2. 通过vite.config.js配置自动导入文件

```scss
// var.scss
$xtxColor: #27ba9b;
$helpColor: #e26237;
$sucColor: #1dc779;
$warnColor: #ffb302;
$priceColor: #cf4444;
```



```js
// vite.config.js
css: {
    preprocessorOptions: {
      scss: {
        // 2、自动导入定制化样式文件进行样式覆盖
        additionalData: `
          @use "@/styles/element/index.scss" as *;
          @use "@/styles/var.scss" as *;
        `,
      },
    },
  },
```





### 10 Layout-静态模板结构搭建

外层有三个组件，分别是 Nav、Header、Footer

创建之后在Layout人口文件中引入渲染



### 11 Layout-字体图标引入

#### 如何引入

阿里的字体图标库支持多种引入方式，小兔鲜项目里采用的是font-class引用的方式

在index.html文件中引入文件，添加下面的代码：

```html
    <link rel="stylesheet" href="//at.alicdn.com/t/font_2143783_iq6z4ey5vu.css">
```

使用：

```html
<i class="iconfont icon-user"></i>
```



### 12 Layout-一级导航渲染

#### 功能描述

使用后端接口渲染一级路由导航

实现步骤：

1. 根据接口文档封装接口函数
2. 发送请求获取数据列表
3. v-for渲染页面

```js
import httpInstance from "@/utils/http.js";

// 获取顶部导航栏数据
export function getCategoryAPI() {
  return httpInstance({
    url: "/home/category/head",
  });
}
```

```vue
<script setup>
import { getCategoryAPI } from "@/apis/layout";

import { ref, onMounted } from "vue";

const categoryList = ref([]);

const getCategory = async () => {
  let res = await getCategoryAPI();
  console.log("res", res);
  if (res.code == "1") {
    categoryList.value = res.result;
  }
};

onMounted(() => {
  getCategory();
});
</script>

<template>
  <header class="app-header">
    <div class="container">
      <h1 class="logo">
        <RouterLink to="/">小兔鲜</RouterLink>
      </h1>
      <ul class="app-header-nav">
        <li class="home" v-for="item in categoryList" :key="item.id">
          <RouterLink to="/">{{ item.name }}</RouterLink>
        </li>
      </ul>
    </div>
  </header>
</template>
```





### 13 Layout-吸顶导航交互实现

#### 吸顶交互

要求：浏览器在上下滚动的过程中，如果距离顶部的滚动距离大于78px，吸顶导航显示，小于78px隐藏



1. 准备吸顶导航组件
2. 获取滚动距离
3. 以滚动距离做判断条件控制组件盒子展示隐藏

```vue
<script setup>
import { useScroll } from "@vueuse/core";

const { y } = useScroll(window);
</script>

<template>
  <div class="app-header-sticky" :class="{ show: y > 78 }">
</template>
```



```css
.app-header-sticky {
  width: 100%;
  height: 80px;
  position: fixed;
  left: 0;
  top: 0;
  z-index: 999;
  background-color: #fff;
  border-bottom: 1px solid #e4e4e4;
  // 此处为关键样式!!!
  // 状态一：往上平移自身高度 + 完全透明
  transform: translateY(-100%);
  opacity: 0;

  // 状态二：移除平移 + 完全不透明
  &.show {
    transition: all 0.3s linear;
    transform: none;
    opacity: 1;
  }

  .container {
    display: flex;
    align-items: center;
  }
}
```































